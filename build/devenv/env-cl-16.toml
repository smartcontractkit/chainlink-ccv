cl_nodes_funding_eth = 50
cl_nodes_funding_link = 50

## Environment configuration define the topology.
[environment_topology]
indexer_address = "http://indexer:8100"
pyroscope_url = "http://host.docker.internal:4040"

[environment_topology.monitoring]
Enabled = true
Type = "beholder"

[environment_topology.monitoring.Beholder]
InsecureConnection = true
OtelExporterHTTPEndpoint = "host.docker.internal:4318"
LogStreamingEnabled = false
MetricReaderInterval = 5
TraceSampleRatio = 1.0
TraceBatchTimeout = 10

[[environment_topology.nop_topology.nops]]
alias = "node-0"
name = "node-0"

[[environment_topology.nop_topology.nops]]
alias = "node-1"
name = "node-1"

[[environment_topology.nop_topology.nops]]
alias = "node-2"
name = "node-2"

[[environment_topology.nop_topology.nops]]
alias = "node-3"
name = "node-3"

[[environment_topology.nop_topology.nops]]
alias = "node-4"
name = "node-4"

[[environment_topology.nop_topology.nops]]
alias = "node-5"
name = "node-5"

[[environment_topology.nop_topology.nops]]
alias = "node-6"
name = "node-6"

[[environment_topology.nop_topology.nops]]
alias = "node-7"
name = "node-7"

[[environment_topology.nop_topology.nops]]
alias = "node-8"
name = "node-8"

[[environment_topology.nop_topology.nops]]
alias = "node-9"
name = "node-9"

[[environment_topology.nop_topology.nops]]
alias = "node-10"
name = "node-10"

[[environment_topology.nop_topology.nops]]
alias = "node-11"
name = "node-11"

[[environment_topology.nop_topology.nops]]
alias = "node-12"
name = "node-12"

[[environment_topology.nop_topology.nops]]
alias = "node-13"
name = "node-13"

[[environment_topology.nop_topology.nops]]
alias = "node-14"
name = "node-14"

[[environment_topology.nop_topology.nops]]
alias = "node-15"
name = "node-15"

[environment_topology.nop_topology.committees.default]
qualifier = "default"
verifier_version = "1.7.0"

[[environment_topology.nop_topology.committees.default.aggregators]]
name = "default"
address = "default-aggregator:50051"
insecure_connection = true

[environment_topology.nop_topology.committees.default.chain_configs.3379446385462418246]
nop_aliases = ["node-0", "node-1", "node-2", "node-3", "node-4", "node-5", "node-6", "node-7", "node-8", "node-9", "node-10", "node-11", "node-12", "node-13", "node-14", "node-15"]
threshold = 16

[environment_topology.nop_topology.committees.default.chain_configs.12922642891491394802]
nop_aliases = ["node-0", "node-1", "node-2", "node-3", "node-4", "node-5", "node-6", "node-7", "node-8", "node-9", "node-10", "node-11", "node-12", "node-13", "node-14", "node-15"]
threshold = 16

[environment_topology.nop_topology.committees.default.chain_configs.4793464827907405086]
nop_aliases = ["node-0", "node-1", "node-2", "node-3", "node-4", "node-5", "node-6", "node-7", "node-8", "node-9", "node-10", "node-11", "node-12", "node-13", "node-14", "node-15"]
threshold = 16

[environment_topology.nop_topology.committees.secondary]
qualifier = "secondary"
verifier_version = "1.7.0"

[[environment_topology.nop_topology.committees.secondary.aggregators]]
name = "default"
address = "secondary-aggregator:50051"
insecure_connection = true

[environment_topology.nop_topology.committees.secondary.chain_configs.3379446385462418246]
nop_aliases = ["node-0", "node-1"]
threshold = 2

[environment_topology.nop_topology.committees.secondary.chain_configs.12922642891491394802]
nop_aliases = ["node-0", "node-1"]
threshold = 2

[environment_topology.nop_topology.committees.secondary.chain_configs.4793464827907405086]
nop_aliases = ["node-0", "node-1"]
threshold = 2

[environment_topology.nop_topology.committees.tertiary]
qualifier = "tertiary"
verifier_version = "1.7.0"

[[environment_topology.nop_topology.committees.tertiary.aggregators]]
name = "default"
address = "tertiary-aggregator:50051"
insecure_connection = true

[environment_topology.nop_topology.committees.tertiary.chain_configs.3379446385462418246]
nop_aliases = ["node-0", "node-1"]
threshold = 2

[environment_topology.nop_topology.committees.tertiary.chain_configs.12922642891491394802]
nop_aliases = ["node-0", "node-1"]
threshold = 2

[environment_topology.nop_topology.committees.tertiary.chain_configs.4793464827907405086]
nop_aliases = ["node-0", "node-1"]
threshold = 2

[environment_topology.executor_pools.default]
nop_aliases = ["node-0", "node-1", "node-2", "node-3", "node-4", "node-5", "node-6", "node-7", "node-8", "node-9", "node-10", "node-11", "node-12", "node-13", "node-14", "node-15"]
execution_interval = 15_000_000_000
indexer_query_limit = 100
backoff_duration = 15_000_000_000
lookback_window = 3_600_000_000_000
reader_cache_expiry = 300_000_000_000
max_retry_duration = 28_800_000_000_000
worker_count = 100
ntp_server = "time.google.com"

[environment_topology.executor_pools.custom]
nop_aliases = ["node-0"]
execution_interval = 15_000_000_000
indexer_query_limit = 100
backoff_duration = 15_000_000_000
lookback_window = 3_600_000_000_000
reader_cache_expiry = 300_000_000_000
max_retry_duration = 28_800_000_000_000
worker_count = 100
ntp_server = "time.google.com"

[cldf]

[jd]
  csa_encryption_key = "d1093c0060d50a3c89c189b2e485da5a3ce57f3dcb38ab7e2c0d5f0bb2314a44" # any random 32 byte hex string
  image = "job-distributor:local"

[pricer]
  image = "pricer:dev"
  source_code_path = "../pricer"
  root_path = "../../"
  [pricer.keystore]
    address = "0x9221E2E83903C731C2927CCd84e5fa02B22Bb1E2"
    file_path = "../pricer/keystore.json"
    password = "keystore_test_password"

[[blockchains]]
  container_name = "blockchain-src"
  chain_id = "1337"
  docker_cmd_params = ["-b", "1", "--mixed-mining", "--slots-in-an-epoch", "1", "--disable-code-size-limit"]
  image = "ghcr.io/foundry-rs/foundry:latest"
  port = "8545"
  type = "anvil"

[[blockchains]]
  container_name = "blockchain-dst"
  chain_id = "2337"
  docker_cmd_params = ["-b", "1", "--mixed-mining", "--slots-in-an-epoch", "1", "--disable-code-size-limit"]
  image = "ghcr.io/foundry-rs/foundry:latest"
  port = "8555"
  type = "anvil"

[[blockchains]]
  container_name = "blockchain-3rd"
  chain_id = "3337"
  docker_cmd_params = ["-b", "1", "--mixed-mining", "--slots-in-an-epoch", "1", "--disable-code-size-limit"]
  image = "ghcr.io/foundry-rs/foundry:latest"
  port = "8565"
  type = "anvil"

[fake]
  image = "ccv-fakes:dev"
  port = 9111
  source_code_path = "../build/devenv/fakes"
  root_path = "../../"

[[nodesets]]
  name = "don-group-1"
  nodes = 4
  override_mode = "each"
  http_port_range_start = 10000
  p2p_port_range_start = 12000

  [nodesets.db]
    image = "postgres:15.0"
    port = 13000

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      CL_EVM_CMD=""

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      CL_EVM_CMD=""

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      CL_EVM_CMD=""

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      CL_EVM_CMD=""

[[nodesets]]
  name = "don-group-2"
  nodes = 4
  override_mode = "each"
  http_port_range_start = 10004
  p2p_port_range_start = 12004

  [nodesets.db]
    image = "postgres:15.0"
    port = 13001

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      CL_EVM_CMD=""

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      CL_EVM_CMD=""

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      CL_EVM_CMD=""

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      CL_EVM_CMD=""

[[nodesets]]
  name = "don-group-3"
  nodes = 4
  override_mode = "each"
  http_port_range_start = 10008
  p2p_port_range_start = 12008

  [nodesets.db]
    image = "postgres:15.0"
    port = 13002

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      CL_EVM_CMD=""

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      CL_EVM_CMD=""

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      CL_EVM_CMD=""

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      CL_EVM_CMD=""

[[nodesets]]
  name = "don-group-4"
  nodes = 4
  override_mode = "each"
  http_port_range_start = 10012
  p2p_port_range_start = 12012

  [nodesets.db]
    image = "postgres:15.0"
    port = 13003

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      CL_EVM_CMD=""

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      CL_EVM_CMD=""

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      CL_EVM_CMD=""

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      CL_EVM_CMD=""

## Default Verifier Setup (16 nodes)
[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-1"
  nop_alias = "node-0"
  port = 8100
  # path is relative from "devenv" dir
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 0
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-1-db"
    port = 8432
  

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-2"
  nop_alias = "node-1"
  port = 8200
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 1
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-2-db"
    port = 8433
  

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-3"
  nop_alias = "node-2"
  port = 8300
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 2
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-3-db"
    port = 8434
  

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-4"
  nop_alias = "node-3"
  port = 8400
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 3
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-4-db"
    port = 8435
  

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-5"
  nop_alias = "node-4"
  port = 8500
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 4
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-5-db"
    port = 8436
  

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-6"
  nop_alias = "node-5"
  port = 8600
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 5
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-6-db"
    port = 8437
  

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-7"
  nop_alias = "node-6"
  port = 8700
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 6
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-7-db"
    port = 8438
  

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-8"
  nop_alias = "node-7"
  port = 9100
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 7
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-8-db"
    port = 8439
  

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-9"
  nop_alias = "node-8"
  port = 9200
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 8
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-9-db"
    port = 8440
  

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-10"
  nop_alias = "node-9"
  port = 9300
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 9
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-10-db"
    port = 8441
  

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-11"
  nop_alias = "node-10"
  port = 9400
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 10
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-11-db"
    port = 8442
  

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-12"
  nop_alias = "node-11"
  port = 9500
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 11
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-12-db"
    port = 8443
  

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-13"
  nop_alias = "node-12"
  port = 9600
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 12
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-13-db"
    port = 8444
  

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-14"
  nop_alias = "node-13"
  port = 9700
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 13
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-14-db"
    port = 8445
  

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-15"
  nop_alias = "node-14"
  port = 9800
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 14
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-15-db"
    port = 8446
  

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-16"
  nop_alias = "node-15"
  port = 10100
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 15
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-16-db"
    port = 8447
  

# Secondary Verifier Setup
[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "secondary-verifier-1"
  nop_alias = "node-0"
  port = 10200
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "secondary"
  node_index = 0
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "secondary-verifier-1-db"
    port = 8448
  

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "secondary-verifier-2"
  nop_alias = "node-1"
  port = 10300
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "secondary"
  node_index = 1
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "secondary-verifier-2-db"
    port = 8449
  

# Tertiary Verifier Setup
[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "tertiary-verifier-1"
  nop_alias = "node-0"
  port = 10400
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "tertiary"
  node_index = 0
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "tertiary-verifier-1-db"
    port = 8450
  

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "tertiary-verifier-2"
  nop_alias = "node-1"
  port = 10500
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "tertiary"
  node_index = 1
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "tertiary-verifier-2-db"
    port = 8451
  

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8101
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-1"
  nop_alias = "node-0"
  executor_qualifier = "default"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8102
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-2"
  nop_alias = "node-1"
  executor_qualifier = "default"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8103
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-3"
  nop_alias = "node-2"
  executor_qualifier = "default"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8104
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-4"
  nop_alias = "node-3"
  executor_qualifier = "default"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8105
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-5"
  nop_alias = "node-4"
  executor_qualifier = "default"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8106
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-6"
  nop_alias = "node-5"
  executor_qualifier = "default"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8107
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-7"
  nop_alias = "node-6"
  executor_qualifier = "default"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8108
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-8"
  nop_alias = "node-7"
  executor_qualifier = "default"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8109
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-9"
  nop_alias = "node-8"
  executor_qualifier = "default"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8110
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-10"
  nop_alias = "node-9"
  executor_qualifier = "default"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8111
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-11"
  nop_alias = "node-10"
  executor_qualifier = "default"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8112
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-12"
  nop_alias = "node-11"
  executor_qualifier = "default"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8113
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-13"
  nop_alias = "node-12"
  executor_qualifier = "default"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8114
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-14"
  nop_alias = "node-13"
  executor_qualifier = "default"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8115
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-15"
  nop_alias = "node-14"
  executor_qualifier = "default"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8116
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-16"
  nop_alias = "node-15"
  executor_qualifier = "default"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8117
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "custom-executor-1"
  nop_alias = "node-0"
  executor_qualifier = "custom"

[[indexer]]
  image = "indexer:dev"
  port = 8103
  source_code_path = "../indexer"
  root_path = "../../"
  [indexer.db]
    image = "postgres:16-alpine"

[indexer.indexer_config]
[indexer.indexer_config.Monitoring]
Enabled = true
Type = 'beholder'

[indexer.indexer_config.Monitoring.Beholder]
InsecureConnection = true
CACertFile = ''
OtelExporterGRPCEndpoint = ''
OtelExporterHTTPEndpoint = 'otel-collector:4318'
LogStreamingEnabled = true
MetricReaderInterval = 5
TraceSampleRatio = 1.0
TraceBatchTimeout = 10

[[indexer.indexer_config.Discoveries]]
Address = "default-aggregator:50051"
Since = 0


PollInterval = 500
Timeout = 5000

[indexer.indexer_config.Scheduler]
TickerInterval = 50
VerificationVisibilityWindow = 28800
BaseDelay = 100 
MaxDelay = 30_000

[indexer.indexer_config.Pool]
ConcurrentWorkers = 1000
WorkerTimeout = 300

[[indexer.indexer_config.Verifier]]
Type = "aggregator"
Name = "CommiteeVerifier (Primary)"
Address = "default-aggregator:50051"
InsecureConnection = true
BatchSize = 100
MaxBatchWaitTime = 50
Since = 0



[[indexer.indexer_config.Verifier]]
Type = "aggregator"
Name = "CommiteeVerifier (Secondary)"
Address = "secondary-aggregator:50051"
InsecureConnection = true
BatchSize = 100
MaxBatchWaitTime = 50
Since = 0



[[indexer.indexer_config.Verifier]]
Type = "aggregator"
Name = "CommiteeVerifier (Tertiary)"
Address = "tertiary-aggregator:50051"
InsecureConnection = true
BatchSize = 100
MaxBatchWaitTime = 50
Since = 0



[indexer.indexer_config.Storage]
Strategy = "sink" 

[[indexer.indexer_config.Storage.Sink.Storages]]
Type = "memory"

[indexer.indexer_config.Storage.Sink.Storages.Memory]
TTL = 3600            
MaxSize = 10000      
CleanupInterval = 300

[[indexer.indexer_config.Storage.Sink.Storages]]
Type = "postgres"

[indexer.indexer_config.Storage.Sink.Storages.Postgres]
URI = "postgresql://indexer:indexer@indexer-db:5432/indexer?sslmode=disable"
MaxOpenConnections = 20
MaxIdleConnections = 5
IdleInTxSessionTimeout = 60
LockTimeout = 30

[indexer.committee_verifier_name_to_qualifier]
"CommiteeVerifier (Primary)" = "default"
"CommiteeVerifier (Secondary)" = "secondary"
"CommiteeVerifier (Tertiary)" = "tertiary"

[[aggregator]]
  committee_name = "default"
  image = "aggregator:dev"
  host_port = 50051
  source_code_path = "../aggregator"
  root_path = "../../"

  [aggregator.db]
    image = "postgres:16-alpine"
    host_port  = 7432
  
  [aggregator.redis]
    image = "redis:7-alpine"
    host_port  = 6379

  [[aggregator.api_clients]]
  client_id = "default-verifier-1"
  description = "Development default verifier 1"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "default-verifier-2"
  description = "Development default verifier 2"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "default-verifier-3"
  description = "Development default verifier 3"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "default-verifier-4"
  description = "Development default verifier 4"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "default-verifier-5"
  description = "Development default verifier 5"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "default-verifier-6"
  description = "Development default verifier 6"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "default-verifier-7"
  description = "Development default verifier 7"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "default-verifier-8"
  description = "Development default verifier 8"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "default-verifier-9"
  description = "Development default verifier 9"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "default-verifier-10"
  description = "Development default verifier 10"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "default-verifier-11"
  description = "Development default verifier 11"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "default-verifier-12"
  description = "Development default verifier 12"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "default-verifier-13"
  description = "Development default verifier 13"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "default-verifier-14"
  description = "Development default verifier 14"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "default-verifier-15"
  description = "Development default verifier 15"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "default-verifier-16"
  description = "Development default verifier 16"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "monitoring"
  description = "Monitoring and infrastructure client"
  enabled = true
  groups = ["monitoring"]

  [[aggregator.api_clients]]
  client_id = "indexer"
  description = "Development Indexer"
  enabled = true
  groups = ["indexer"]

  # Environment variables for sensitive configuration
  [aggregator.env]
    storage_connection_url = "postgresql://aggregator:aggregator@default-aggregator-db:5432/aggregator?sslmode=disable"
    redis_address = "default-aggregator-redis:6379"
    redis_password = ""
    redis_db = "0"

[[aggregator]]
  committee_name = "secondary"
  image = "aggregator:dev"
  host_port = 50052
  source_code_path = "../aggregator"
  root_path = "../../"

  [aggregator.db]
    image = "postgres:16-alpine"
    host_port  = 7433
  
  [aggregator.redis]
    image = "redis:7-alpine"
    host_port  = 6380

  [[aggregator.api_clients]]
  client_id = "secondary-verifier-1"
  description = "Development secondary verifier 1"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "secondary-verifier-2"
  description = "Development secondary verifier 2"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "monitoring"
  description = "Monitoring and infrastructure client"
  enabled = true
  groups = ["monitoring"]

  [[aggregator.api_clients]]
  client_id = "indexer"
  description = "Development Indexer"
  enabled = true
  groups = ["indexer"]

  # Environment variables for sensitive configuration
  [aggregator.env]
    storage_connection_url = "postgresql://aggregator:aggregator@secondary-aggregator-db:5432/aggregator?sslmode=disable"
    redis_address = "secondary-aggregator-redis:6379"
    redis_password = ""
    redis_db = "0"

[[aggregator]]
  committee_name = "tertiary"
  image = "aggregator:dev"
  host_port = 50053
  source_code_path = "../aggregator"
  root_path = "../../"

  [aggregator.db]
    image = "postgres:16-alpine"
    host_port  = 7434
  
  [aggregator.redis]
    image = "redis:7-alpine"
    host_port  = 6381

  [[aggregator.api_clients]]
  client_id = "tertiary-verifier-1"
  description = "Development tertiary verifier 1"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "tertiary-verifier-2"
  description = "Development tertiary verifier 2"
  enabled = true
  groups = ["verifiers"]

  [[aggregator.api_clients]]
  client_id = "monitoring"
  description = "Monitoring and infrastructure client"
  enabled = true
  groups = ["monitoring"]

  [[aggregator.api_clients]]
  client_id = "indexer"
  description = "Development Indexer"
  enabled = true
  groups = ["indexer"]

  # Environment variables for sensitive configuration
  [aggregator.env]
    storage_connection_url = "postgresql://aggregator:aggregator@tertiary-aggregator-db:5432/aggregator?sslmode=disable"
    redis_address = "tertiary-aggregator-redis:6379"
    redis_password = ""
    redis_db = "0"
