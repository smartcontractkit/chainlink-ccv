## CL mode environment topology for 2-node setup
[environment_topology]
indexer_address = "http://indexer:8100"
pyroscope_url = "http://host.docker.internal:4040"

[environment_topology.monitoring]
Enabled = true
Type = "beholder"

[environment_topology.monitoring.Beholder]
InsecureConnection = true
OtelExporterHTTPEndpoint = "host.docker.internal:4318"
LogStreamingEnabled = false
MetricReaderInterval = 5
TraceSampleRatio = 1.0
TraceBatchTimeout = 10

[[environment_topology.nop_topology.nops]]
alias = "node-0"
name = "node-0"

[[environment_topology.nop_topology.nops]]
alias = "node-1"
name = "node-1"

[environment_topology.nop_topology.committees.default]
qualifier = "default"
verifier_version = "1.7.0"

[[environment_topology.nop_topology.committees.default.aggregators]]
name = "default"
address = "default-aggregator:50051"
insecure_connection = true

[environment_topology.nop_topology.committees.default.chain_configs.3379446385462418246]
nop_aliases = ["node-0", "node-1"]
threshold = 2

[environment_topology.nop_topology.committees.default.chain_configs.12922642891491394802]
nop_aliases = ["node-0", "node-1"]
threshold = 2

[environment_topology.nop_topology.committees.default.chain_configs.4793464827907405086]
nop_aliases = ["node-0", "node-1"]
threshold = 2

[environment_topology.nop_topology.committees.secondary]
qualifier = "secondary"
verifier_version = "1.7.0"

[[environment_topology.nop_topology.committees.secondary.aggregators]]
name = "default"
address = "secondary-aggregator:50051"
insecure_connection = true

[environment_topology.nop_topology.committees.secondary.chain_configs.3379446385462418246]
nop_aliases = ["node-0", "node-1"]
threshold = 2

[environment_topology.nop_topology.committees.secondary.chain_configs.12922642891491394802]
nop_aliases = ["node-0", "node-1"]
threshold = 2

[environment_topology.nop_topology.committees.secondary.chain_configs.4793464827907405086]
nop_aliases = ["node-0", "node-1"]
threshold = 2

[environment_topology.nop_topology.committees.tertiary]
qualifier = "tertiary"
verifier_version = "1.7.0"

[[environment_topology.nop_topology.committees.tertiary.aggregators]]
name = "default"
address = "tertiary-aggregator:50051"
insecure_connection = true

[environment_topology.nop_topology.committees.tertiary.chain_configs.3379446385462418246]
nop_aliases = ["node-0", "node-1"]
threshold = 2

[environment_topology.nop_topology.committees.tertiary.chain_configs.12922642891491394802]
nop_aliases = ["node-0", "node-1"]
threshold = 2

[environment_topology.nop_topology.committees.tertiary.chain_configs.4793464827907405086]
nop_aliases = ["node-0", "node-1"]
threshold = 2

[environment_topology.executor_pools.default]
nop_aliases = ["node-0", "node-1"]
execution_interval = 15_000_000_000
indexer_query_limit = 100
backoff_duration = 15_000_000_000
lookback_window = 3_600_000_000_000
reader_cache_expiry = 300_000_000_000
max_retry_duration = 28_800_000_000_000
worker_count = 100
ntp_server = "time.google.com"

[environment_topology.executor_pools.custom]
nop_aliases = ["node-0"]
execution_interval = 15_000_000_000
indexer_query_limit = 100
backoff_duration = 15_000_000_000
lookback_window = 3_600_000_000_000
reader_cache_expiry = 300_000_000_000
max_retry_duration = 28_800_000_000_000
worker_count = 100
ntp_server = "time.google.com"

[[nodesets]]
  name = "don"
  nodes = 2
  override_mode = "each"

  [nodesets.db]
    image = "postgres:15.0"

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      CL_EVM_CMD=""

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      CL_EVM_CMD=""

## Default Verifier Setup (2 nodes)
[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-1"
  nop_alias = "node-0"
  port = 8100
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 0
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-1-db"
    port = 8432

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-2"
  nop_alias = "node-1"
  port = 8200
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 1
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-2-db"
    port = 8433

# Secondary Verifier Setup (shares same 2 nodes)
[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "secondary-verifier-1"
  nop_alias = "node-0"
  port = 8300
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "secondary"
  node_index = 0
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "secondary-verifier-1-db"
    port = 8434

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "secondary-verifier-2"
  nop_alias = "node-1"
  port = 8400
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "secondary"
  node_index = 1
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "secondary-verifier-2-db"
    port = 8435

# Tertiary Verifier Setup (shares same 2 nodes)
[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "tertiary-verifier-1"
  nop_alias = "node-0"
  port = 8500
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "tertiary"
  node_index = 0
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "tertiary-verifier-1-db"
    port = 8436

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "tertiary-verifier-2"
  nop_alias = "node-1"
  port = 8600
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "tertiary"
  node_index = 1
  insecure_aggregator_connection = true
  [verifier.db]
    image = "postgres:16-alpine"
    name = "tertiary-verifier-2-db"
    port = 8437

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8101
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-1"
  nop_alias = "node-0"
  executor_qualifier = "default"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8102
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-2"
  nop_alias = "node-1"
  executor_qualifier = "default"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8103
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "custom-executor-1"
  nop_alias = "node-0"
  executor_qualifier = "custom"
