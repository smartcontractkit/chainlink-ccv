[[nodesets]]
  name = "don"
  nodes = 2
  override_mode = "each"

  [nodesets.db]
    image = "postgres:15.0"

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      # XXX: this is required for the integration to work
      CL_EVM_CMD=""

  [[nodesets.node_specs]]

    [nodesets.node_specs.node]
      docker_ctx = "../../../chainlink"
      docker_file = "plugins/chainlink.Dockerfile"

    [nodesets.node_specs.node.env_vars]
      # XXX: this is required for the integration to work
      CL_EVM_CMD=""

## Default Verifier Setup
[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-1"
  port = 8100
  # path is relative from "devenv" dir
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 0
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-1-db"
    port = 8432
  
  # Environment variables for sensitive configuration
  [verifier.env]
    aggregator_api_key = "dev-api-key-verifier-1"
    aggregator_secret_key = "dev-secret-verifier-1"

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "default-verifier-2"
  port = 8200
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "default"
  node_index = 1
  [verifier.db]
    image = "postgres:16-alpine"
    name = "default-verifier-2-db"
    port = 8433
  
  # Environment variables for sensitive configuration
  [verifier.env]
    aggregator_api_key = "dev-api-key-verifier-2"
    aggregator_secret_key = "dev-secret-verifier-2"

# Secondary Verifier Setup
[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "secondary-verifier-1"
  port = 8300
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "secondary"
  node_index = 0
  [verifier.db]
    image = "postgres:16-alpine"
    name = "secondary-verifier-1-db"
    port = 8434
  
  # Environment variables for sensitive configuration
  [verifier.env]
    aggregator_api_key = "dev-api-key-secondary-verifier-1"
    aggregator_secret_key = "dev-secret-secondary-verifier-1"

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "secondary-verifier-2"
  port = 8400
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "secondary"
  node_index = 1
  [verifier.db]
    image = "postgres:16-alpine"
    name = "secondary-verifier-2-db"
    port = 8435
  
  # Environment variables for sensitive configuration
  [verifier.env]
    aggregator_api_key = "dev-api-key-secondary-verifier-2"
    aggregator_secret_key = "dev-secret-secondary-verifier-2"

# Tertiary Verifier Setup
[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "tertiary-verifier-1"
  port = 8500
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "tertiary"
  node_index = 0
  [verifier.db]
    image = "postgres:16-alpine"
    name = "tertiary-verifier-1-db"
    port = 8436
  
  # Environment variables for sensitive configuration
  [verifier.env]
    aggregator_api_key = "dev-api-key-tertiary-verifier-1"
    aggregator_secret_key = "dev-secret-tertiary-verifier-1"

[[verifier]]
  mode = "cl"
  image = "verifier:dev"
  container_name = "tertiary-verifier-2"
  port = 8600
  source_code_path = "../verifier"
  root_path = "../../"
  committee_name = "tertiary"
  node_index = 1
  [verifier.db]
    image = "postgres:16-alpine"
    name = "tertiary-verifier-2-db"
    port = 8437
  
  # Environment variables for sensitive configuration
  [verifier.env]
    aggregator_api_key = "dev-api-key-tertiary-verifier-2"
    aggregator_secret_key = "dev-secret-tertiary-verifier-2"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8101
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-1"

[[executor]]
  mode = "cl"
  image = "executor:dev"
  port = 8102
  source_code_path = "../executor"
  root_path = "../../"
  container_name = "default-executor-2"
